### 剑指 Offer II 004. 只出现一次的数字

给你一个整数数组 nums ，除某个元素仅出现 一次 外，其余每个元素都恰出现 三次 。请你找出并返回那个只出现了一次的元素。

输入：nums = [2,2,3,2]
输出：3

输入：nums = [0,1,0,1,0,1,100]
输出：100

- 1 <= nums.length <= 3 \* 104
- -231 <= nums[i] <= 231 - 1
- nums 中，除某个元素仅出现 一次 外，其余每个元素都恰出现 三次

很熟悉的题型了，使用位运算

分析：
每个数字的二进制都是一样的，把他们二进制每个位的 1 进行累加，只有一个元素出现了一次，其余元素出现了 3 次，每一位都对 3 进行求余，剩下的就是单独出现的元素的二进制

```python

class Solution:
    def singleNumber(self, nums: List[int]) -> int:
        ret = 0
        for i in range(32):
            count = 0
            for num in nums:
                #先遍历32位数，每个二进制位求和，这样可以减少存储空间，如果是先遍历每个数然后累积的话需要创建一个32长度的列表每个存储

                count += num >> i & 1  # 第i位上是否为1

            #这里的关键理解是-1是 11111111表示的，（长度是28位，这里缩写了些）
            #（-1）-1=-2，-2是11111110表示的，依次类推，因此统计负数的时候，也会在高位统计1
            #对于python而言 一个数的存储大小是动态分配的，可以用sys.getsizeof(a)看到

            #以输入列表只有[-1]为例子，当-1>>30时，python3会算到第31位为1， ans的第31位会置为1
            #当-1>>31时，python3会算到第32位为1，按照有符号数的思想，ans的第32位会置为1表示这个是个负数
            #但是当1<<31时，这会变成2^31次方 0|1<<31也是一样的，即python按照位运算右移的时候会保存负数的高位1
            #但是直接或的话会让原来的数加了2**31，因此要-1<<31，这样的话按照负数的表示方法 用减法减掉一样可以得到负数
            #换句话说 如果把32位负数的符号位变为0会得到一个正数，这个正数和负数的关系是 正数-(1<<3)1=负数
            if count % 3:
                if i == 31:
                    ret -= (1 << i)
                else:
                    ret |= 1 << i

        return ret

```

go 版本,

```go

func singleNumber(nums []int) int {
    ret := 0
    for i:=0; i<32; i++{
        count := 0
        for _, num := range nums {
            count += num >> i & 1
        }

        if count % 3 != 0 {
            ret |= 1 << i
        }
    }

    return ret

}


```

需要注意优先级，以及根据操作系统分 32 和 64 位

```go

func singleNumber(nums []int) int {
    ret := int32(0) //go这里int根据CPU多少位决定, 显然lc的是64位。不指定的话一开始我还错了，以为是按照int32来枚举的。
     //负数的话会有符号位

    for i:=0; i<32; i++{
        count := int32(0)
        for _, num := range nums {
            count += int32(num >> i) & 1
        }

        if count % 3 > 0 {
            ret |= 1 << i
        }
    }

    return int(ret)

}



```
